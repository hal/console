(0,("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}).parcelRequire25b9.register)("02lid",function(e,t){Object.defineProperty(e.exports,"default",{get:function(){return r},set:void 0,enumerable:!0,configurable:!0});class r{#e=[];#t;#r=!0;#i;#o=this.#s(console.info);#n=this.#s(console.warn);#a={enable:!0,callbackList:[],interval:5};#l;didInitialize=!1;authenticated=!1;loginRequired=!1;responseMode="fragment";responseType="code";flow="standard";timeSkew=null;redirectUri;silentCheckSsoRedirectUri;silentCheckSsoFallback=!0;pkceMethod="S256";enableLogging=!1;logoutMethod="GET";scope;messageReceiveTimeout=1e4;idToken;idTokenParsed;token;tokenParsed;refreshToken;refreshTokenParsed;clientId;sessionId;subject;authServerUrl;realm;realmAccess;resourceAccess;profile;userInfo;endpoints;tokenTimeoutHandle;onAuthSuccess;onAuthError;onAuthRefreshSuccess;onAuthRefreshError;onTokenExpired;onAuthLogout;onReady;onActionUpdate;constructor(e){if("string"!=typeof e&&!d(e))throw Error("The 'Keycloak' constructor must be provided with a configuration object, or a URL to a JSON configuration file.");if(d(e)){for(let t of"oidcProvider"in e?["clientId"]:["url","realm","clientId"])if(!(t in e))throw Error(`The configuration object is missing the required '${t}' property.`)}globalThis.isSecureContext||this.#n("[KEYCLOAK] Keycloak JS must be used in a 'secure context' to function properly as it relies on browser APIs that are otherwise not available.\nContinuing to run your application insecurely will lead to unexpected behavior and breakage.\n\nFor more information see: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts"),this.#l=e}init=async(e={})=>{if(this.didInitialize)throw Error("A 'Keycloak' instance can only be initialized once.");if(this.didInitialize=!0,this.#i=function(){try{return new n}catch(e){return new a}}(),"string"==typeof e.adapter&&["default","cordova","cordova-native"].includes(e.adapter)?this.#t=this.#c(e.adapter):"object"==typeof e.adapter?this.#t=e.adapter:"Cordova"in window||"cordova"in window?this.#t=this.#c("cordova"):this.#t=this.#c("default"),void 0!==e.useNonce&&(this.#r=e.useNonce),void 0!==e.checkLoginIframe&&(this.#a.enable=e.checkLoginIframe),e.checkLoginIframeInterval&&(this.#a.interval=e.checkLoginIframeInterval),"login-required"===e.onLoad&&(this.loginRequired=!0),e.responseMode)if("query"===e.responseMode||"fragment"===e.responseMode)this.responseMode=e.responseMode;else throw Error("Invalid value for responseMode");if(e.flow){switch(e.flow){case"standard":this.responseType="code";break;case"implicit":this.responseType="id_token token";break;case"hybrid":this.responseType="code id_token token";break;default:throw Error("Invalid value for flow")}this.flow=e.flow}if("number"==typeof e.timeSkew&&(this.timeSkew=e.timeSkew),e.redirectUri&&(this.redirectUri=e.redirectUri),e.silentCheckSsoRedirectUri&&(this.silentCheckSsoRedirectUri=e.silentCheckSsoRedirectUri),"boolean"==typeof e.silentCheckSsoFallback&&(this.silentCheckSsoFallback=e.silentCheckSsoFallback),void 0!==e.pkceMethod){if("S256"!==e.pkceMethod&&!1!==e.pkceMethod)throw TypeError(`Invalid value for pkceMethod', expected 'S256' or false but got ${e.pkceMethod}.`);this.pkceMethod=e.pkceMethod}return"boolean"==typeof e.enableLogging&&(this.enableLogging=e.enableLogging),"POST"===e.logoutMethod&&(this.logoutMethod="POST"),"string"==typeof e.scope&&(this.scope=e.scope),"number"==typeof e.messageReceiveTimeout&&e.messageReceiveTimeout>0&&(this.messageReceiveTimeout=e.messageReceiveTimeout),await this.#d(),await this.#h(),await this.#u(e),this.onReady?.(this.authenticated),this.authenticated};#c(e){if("default"===e)return this.#p();if("cordova"===e)return this.#a.enable=!1,this.#f();if("cordova-native"===e)return this.#a.enable=!1,this.#g();throw Error("invalid adapter type: "+e)}#p(){let e=e=>e?.redirectUri||this.redirectUri||globalThis.location.href;return{login:async e=>(window.location.assign(await this.createLoginUrl(e)),await new Promise(()=>{})),logout:async t=>{if("GET"===(t?.logoutMethod??this.logoutMethod))return void window.location.replace(this.createLogoutUrl(t));let r=document.createElement("form");for(let[i,o]of(r.setAttribute("method","POST"),r.setAttribute("action",this.createLogoutUrl(t)),r.style.display="none",Object.entries({id_token_hint:this.idToken,client_id:this.clientId,post_logout_redirect_uri:e(t)}))){let e=document.createElement("input");e.setAttribute("type","hidden"),e.setAttribute("name",i),e.setAttribute("value",o),r.appendChild(e)}document.body.appendChild(r),r.submit()},register:async e=>(window.location.assign(await this.createRegisterUrl(e)),await new Promise(()=>{})),accountManagement:async()=>{let e=this.createAccountUrl();if(void 0!==e)window.location.href=e;else throw Error("Not supported by the OIDC server");return await new Promise(()=>{})},redirectUri:e}}#f(){let e=(e,t,r)=>window.cordova&&window.cordova.InAppBrowser?window.cordova.InAppBrowser.open(e,t,r):window.open(e,t,r),t=e=>{let t=e&&e.cordovaOptions?Object.keys(e.cordovaOptions).reduce((t,r)=>(t[r]=e.cordovaOptions[r],t),{}):{};return t.location="no",e&&"none"===e.prompt&&(t.hidden="yes"),Object.keys(t).reduce((e,r)=>(e.push(r+"="+t[r]),e),[]).join(",")},r=()=>this.redirectUri||"http://localhost";return{login:async i=>{let o=t(i),s=e(await this.createLoginUrl(i),"_blank",o),n=!1,a=!1;function l(){a=!0,s.close()}return await new Promise((e,t)=>{s.addEventListener("loadstart",async i=>{if(0===i.url.indexOf(r())){let r=this.#k(i.url);try{await this.#m(r),e()}catch(e){t(e)}l(),n=!0}}),s.addEventListener("loaderror",async i=>{if(!n)if(0===i.url.indexOf(r())){let r=this.#k(i.url);try{await this.#m(r),e()}catch(e){t(e)}l(),n=!0}else t(Error("Unable to process login.")),l()}),s.addEventListener("exit",function(e){a||t(Error("User closed the login window."))})})},logout:async t=>{let i=e(this.createLogoutUrl(t),"_blank","location=no,hidden=yes,clearcache=yes"),o=!1;i.addEventListener("loadstart",e=>{0===e.url.indexOf(r())&&i.close()}),i.addEventListener("loaderror",e=>{0===e.url.indexOf(r())||(o=!0),i.close()}),await new Promise((e,t)=>{i.addEventListener("exit",()=>{o?t(Error("User closed the login window.")):(this.clearToken(),e())})})},register:async i=>{let o=e(await this.createRegisterUrl(),"_blank",t(i)),s=new Promise((e,t)=>{o.addEventListener("loadstart",async i=>{if(0===i.url.indexOf(r())){o.close();let r=this.#k(i.url);try{await this.#m(r),e()}catch(e){t(e)}}})});await s},accountManagement:async()=>{let t=this.createAccountUrl();if(void 0!==t){let i=e(t,"_blank","location=no");i.addEventListener("loadstart",function(e){0===e.url.indexOf(r())&&i.close()})}else throw Error("Not supported by the OIDC server")},redirectUri:()=>r()}}#g(){return{login:async e=>{let t=await this.createLoginUrl(e);await new Promise((e,r)=>{universalLinks.subscribe("keycloak",async t=>{universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();let i=this.#k(t.url);try{await this.#m(i),e()}catch(e){r(e)}}),window.cordova.plugins.browsertab.openUrl(t)})},logout:async e=>{let t=this.createLogoutUrl(e);await new Promise(e=>{universalLinks.subscribe("keycloak",()=>{universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close(),this.clearToken(),e()}),window.cordova.plugins.browsertab.openUrl(t)})},register:async e=>{let t=await this.createRegisterUrl(e);await new Promise((e,r)=>{universalLinks.subscribe("keycloak",async t=>{universalLinks.unsubscribe("keycloak"),window.cordova.plugins.browsertab.close();let i=this.#k(t.url);try{await this.#m(i),e()}catch(e){r(e)}}),window.cordova.plugins.browsertab.openUrl(t)})},accountManagement:async()=>{let e=this.createAccountUrl();if(void 0!==e)window.cordova.plugins.browsertab.openUrl(e);else throw Error("Not supported by the OIDC server")},redirectUri:e=>e&&e.redirectUri?e.redirectUri:this.redirectUri?this.redirectUri:"http://localhost"}}async #d(){if("string"==typeof this.#l){let e=await h(this.#l);this.authServerUrl=e["auth-server-url"],this.realm=e.realm,this.clientId=e.resource,this.#w()}else this.clientId=this.#l.clientId,"oidcProvider"in this.#l?await this.#b(this.#l.oidcProvider):(this.authServerUrl=this.#l.url,this.realm=this.#l.realm,this.#w())}#w(){this.endpoints={authorize:()=>this.#y()+"/protocol/openid-connect/auth",token:()=>this.#y()+"/protocol/openid-connect/token",logout:()=>this.#y()+"/protocol/openid-connect/logout",checkSessionIframe:()=>this.#y()+"/protocol/openid-connect/login-status-iframe.html",thirdPartyCookiesIframe:()=>this.#y()+"/protocol/openid-connect/3p-cookies/step1.html",register:()=>this.#y()+"/protocol/openid-connect/registrations",userinfo:()=>this.#y()+"/protocol/openid-connect/userinfo"}}async #b(e){if("string"==typeof e){let t=`${w(e)}/.well-known/openid-configuration`,r=await u(t);this.#v(r)}else this.#v(e)}#v(e){this.endpoints={authorize:()=>e.authorization_endpoint,token:()=>e.token_endpoint,logout(){if(!e.end_session_endpoint)throw Error("Not supported by the OIDC server");return e.end_session_endpoint},checkSessionIframe(){if(!e.check_session_iframe)throw Error("Not supported by the OIDC server");return e.check_session_iframe},register(){throw Error('Redirection to "Register user" page not supported in standard OIDC mode')},userinfo(){if(!e.userinfo_endpoint)throw Error("Not supported by the OIDC server");return e.userinfo_endpoint}}}async #h(){var e,t;let r;if(!this.#a.enable&&!this.silentCheckSsoRedirectUri||"function"!=typeof this.endpoints.thirdPartyCookiesIframe)return;let i=document.createElement("iframe");i.setAttribute("src",this.endpoints.thirdPartyCookiesIframe()),i.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),i.setAttribute("title","keycloak-3p-check-iframe"),i.style.display="none",document.body.appendChild(i);let o=new Promise(e=>{let t=r=>{i.contentWindow===r.source&&("supported"===r.data||"unsupported"===r.data)&&("unsupported"===r.data&&(this.#n("[KEYCLOAK] Your browser is blocking access to 3rd-party cookies, this means:\n\n - It is not possible to retrieve tokens without redirecting to the Keycloak server (a.k.a. no support for silent authentication).\n - It is not possible to automatically detect changes to the session status (such as the user logging out in another tab).\n\nFor more information see: https://www.keycloak.org/securing-apps/javascript-adapter#_modern_browsers"),this.#a.enable=!1,this.silentCheckSsoFallback&&(this.silentCheckSsoRedirectUri=void 0)),document.body.removeChild(i),window.removeEventListener("message",t),e())};window.addEventListener("message",t,!1)});return await (e=o,t=this.messageReceiveTimeout,Promise.race([e,new Promise(function(e,i){r=window.setTimeout(function(){i(Error("Timeout when waiting for 3rd party check iframe message."))},t)})]).finally(function(){clearTimeout(r)}))}async #u(e){let t=this.#k(window.location.href);if(t?.newUrl&&window.history.replaceState(window.history.state,"",t.newUrl),t&&t.valid){await this.#I(),await this.#m(t);return}let r=async t=>{let r={};t||(r.prompt="none"),e.locale&&(r.locale=e.locale),await this.login(r)},i=async()=>{switch(e.onLoad){case"check-sso":this.#a.enable?(await this.#I(),await this.#U()||(this.silentCheckSsoRedirectUri?await this.#S():await r(!1))):this.silentCheckSsoRedirectUri?await this.#S():await r(!1);break;case"login-required":await r(!0);break;default:throw Error("Invalid value for onLoad")}};if(e.token&&e.refreshToken)if(this.#C(e.token,e.refreshToken,e.idToken),this.#a.enable)await this.#I(),await this.#U()&&(this.onAuthSuccess?.(),this.#_());else try{await this.updateToken(-1),this.onAuthSuccess?.()}catch(t){if(this.onAuthError?.(),e.onLoad)await i();else throw t}else e.onLoad&&await i()}async #I(){if(!this.#a.enable||this.#a.iframe)return;let e=document.createElement("iframe");this.#a.iframe=e,e.setAttribute("src",this.endpoints.checkSessionIframe()),e.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),e.setAttribute("title","keycloak-session-iframe"),e.style.display="none",document.body.appendChild(e),window.addEventListener("message",e=>{if(e.origin!==this.#a.iframeOrigin||this.#a.iframe?.contentWindow!==e.source||"unchanged"!==e.data&&"changed"!==e.data&&"error"!==e.data)return;"unchanged"!==e.data&&this.clearToken();let t=this.#a.callbackList;for(let r of(this.#a.callbackList=[],t.reverse()))"error"===e.data?r(Error("Error while checking login iframe")):r(null,"unchanged"===e.data)},!1);let t=new Promise(t=>{e.addEventListener("load",()=>{let e=this.endpoints.authorize();e.startsWith("/")?this.#a.iframeOrigin=globalThis.location.origin:this.#a.iframeOrigin=new URL(e).origin,t()})});await t}async #U(){if(!this.#a.iframe||!this.#a.iframeOrigin)return;let e=`${this.clientId} ${this.sessionId?this.sessionId:""}`,t=this.#a.iframeOrigin,r=new Promise((r,i)=>{this.#a.callbackList.push((e,t)=>e?i(e):r(t)),1===this.#a.callbackList.length&&this.#a.iframe?.contentWindow?.postMessage(e,t)});return await r}async #S(){let e=document.createElement("iframe"),t=await this.createLoginUrl({prompt:"none",redirectUri:this.silentCheckSsoRedirectUri});return e.setAttribute("src",t),e.setAttribute("sandbox","allow-storage-access-by-user-activation allow-scripts allow-same-origin"),e.setAttribute("title","keycloak-silent-check-sso"),e.style.display="none",document.body.appendChild(e),await new Promise((t,r)=>{let i=async o=>{if(o.origin!==window.location.origin||e.contentWindow!==o.source)return;let s=this.#k(o.data);try{await this.#m(s),t()}catch(e){r(e)}document.body.removeChild(e),window.removeEventListener("message",i)};window.addEventListener("message",i)})}#k(e){let t=this.#T(e);if(!t)return;let r=this.#i.get(t.state);return r&&(t.valid=!0,t.redirectUri=r.redirectUri,t.storedNonce=r.nonce,t.prompt=r.prompt,t.pkceCodeVerifier=r.pkceCodeVerifier,t.loginOptions=r.loginOptions),t}#T(e){let t,r=[];switch(this.flow){case"standard":r=["code","state","session_state","kc_action_status","kc_action","iss"];break;case"implicit":r=["access_token","token_type","id_token","state","session_state","expires_in","kc_action_status","kc_action","iss"];break;case"hybrid":r=["access_token","token_type","id_token","code","state","session_state","expires_in","kc_action_status","kc_action","iss"]}r.push("error"),r.push("error_description"),r.push("error_uri");let i=new URL(e),o="";if("query"===this.responseMode&&i.searchParams.size>0?(t=this.#E(i.search,r),i.search=t.paramsString,o=i.toString()):"fragment"===this.responseMode&&i.hash.length>0&&(t=this.#E(i.hash.substring(1),r),i.hash=t.paramsString,o=i.toString()),t?.oauthParams){if("standard"===this.flow||"hybrid"===this.flow){if((t.oauthParams.code||t.oauthParams.error)&&t.oauthParams.state)return t.oauthParams.newUrl=o,t.oauthParams}else if("implicit"===this.flow&&(t.oauthParams.access_token||t.oauthParams.error)&&t.oauthParams.state)return t.oauthParams.newUrl=o,t.oauthParams}}#E(e,t){let r=new URLSearchParams(e),i={};for(let[e,o]of Array.from(r.entries()))t.includes(e)&&(i[e]=o,r.delete(e));return{paramsString:r.toString(),oauthParams:i}}async #m(e){let{code:t,error:r,prompt:i}=e,o=new Date().getTime(),s=(t,r,i)=>{if(o=(o+new Date().getTime())/2,this.#C(t,r,i,o),this.#r&&this.idTokenParsed&&this.idTokenParsed.nonce!==e.storedNonce)throw this.#o("[KEYCLOAK] Invalid nonce, clearing token"),this.clearToken(),Error("Invalid nonce.")};if(e.kc_action_status&&this.onActionUpdate&&this.onActionUpdate(e.kc_action_status,e.kc_action),r){if("none"!==i)if(e.error_description&&"authentication_expired"===e.error_description)await this.login(e.loginOptions);else{let t={error:r,error_description:e.error_description};throw this.onAuthError?.(t),t}return}if("standard"!==this.flow&&(e.access_token||e.id_token)&&(s(e.access_token,void 0,e.id_token),this.onAuthSuccess?.()),"implicit"!==this.flow&&t)try{let r=await p(this.endpoints.token(),t,this.clientId,e.redirectUri,e.pkceCodeVerifier);s(r.access_token,r.refresh_token,r.id_token),"standard"===this.flow&&this.onAuthSuccess?.(),this.#_()}catch(e){throw this.onAuthError?.(),e}}async #_(){this.#a.enable&&this.token&&(await y(1e3*this.#a.interval),await this.#U()&&await this.#_())}login=e=>this.#t.login(e);createLoginUrl=async e=>{let t=i(),r=i(),s=this.#t.redirectUri(e),n={state:t,nonce:r,redirectUri:s,loginOptions:e};e?.prompt&&(n.prompt=e.prompt);let a=e?.action==="register"?this.endpoints.register():this.endpoints.authorize(),l=e?.scope||this.scope,c=l?l.split(" "):[];c.includes("openid")||c.unshift("openid"),l=c.join(" ");let d=new URLSearchParams([["client_id",this.clientId],["redirect_uri",s],["state",t],["response_mode",this.responseMode],["response_type",this.responseType],["scope",l]]);if(this.#r&&d.append("nonce",r),e?.prompt&&d.append("prompt",e.prompt),"number"==typeof e?.maxAge&&d.append("max_age",e.maxAge.toString()),e?.loginHint&&d.append("login_hint",e.loginHint),e?.idpHint&&d.append("kc_idp_hint",e.idpHint),e?.action&&"register"!==e.action&&d.append("kc_action",e.action),e?.locale&&d.append("ui_locales",e.locale),e?.acr&&d.append("claims",JSON.stringify({id_token:{acr:e.acr}})),e?.acrValues&&d.append("acr_values",e.acrValues),this.pkceMethod)try{let e=function(e){var t=96,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let i=function(e){if("undefined"==typeof crypto||void 0===crypto.getRandomValues)throw Error("Web Crypto API is not available.");return crypto.getRandomValues(new Uint8Array(e))}(t),o=Array(t);for(let e=0;e<t;e++)o[e]=r.charCodeAt(i[e]%r.length);return String.fromCharCode.apply(null,o)}(96),t=await o(this.pkceMethod,e);n.pkceCodeVerifier=e,d.append("code_challenge",t),d.append("code_challenge_method",this.pkceMethod)}catch(e){throw Error("Failed to generate PKCE challenge.",{cause:e})}return this.#i.add(n),`${a}?${d.toString()}`};logout=e=>this.#t.logout(e);createLogoutUrl=e=>{let t=e?.logoutMethod??this.logoutMethod,r=this.endpoints.logout();if("POST"===t)return r;let i=new URLSearchParams([["client_id",this.clientId],["post_logout_redirect_uri",this.#t.redirectUri(e)]]);return this.idToken&&i.append("id_token_hint",this.idToken),`${r}?${i.toString()}`};register=e=>this.#t.register(e);createRegisterUrl=e=>this.createLoginUrl({...e,action:"register"});createAccountUrl=e=>{let t=this.#y();if(!t)throw Error("Unable to create account URL, make sure the adapter is not configured using a generic OIDC provider.");let r=new URLSearchParams([["referrer",this.clientId],["referrer_uri",this.#t.redirectUri(e)]]);return`${t}/account?${r.toString()}`};accountManagement=()=>this.#t.accountManagement();hasRealmRole=e=>{let t=this.realmAccess;return!!t&&t.roles.indexOf(e)>=0};hasResourceRole=(e,t)=>{if(!this.resourceAccess)return!1;let r=this.resourceAccess[t||this.clientId];return!!r&&r.roles.indexOf(e)>=0};loadUserProfile=async()=>{let e=this.#y();if(!e)throw Error("Unable to load user profile, make sure the adapter is not configured using a generic OIDC provider.");let t=`${e}/account`,r=await g(t,{headers:[m(this.token)]});return this.profile=r};loadUserInfo=async()=>{let e=this.endpoints.userinfo(),t=await g(e,{headers:[m(this.token)]});return this.userInfo=t};isTokenExpired=e=>{if(!this.tokenParsed||!this.refreshToken&&"implicit"!==this.flow)throw Error("Not authenticated");if(null==this.timeSkew)return this.#o("[KEYCLOAK] Unable to determine if token is expired as timeskew is not set"),!0;if("number"!=typeof this.tokenParsed.exp)return!1;let t=this.tokenParsed.exp-Math.ceil(new Date().getTime()/1e3)+this.timeSkew;if(e){if(isNaN(e))throw Error("Invalid minValidity");t-=e}return t<0};updateToken=async e=>{if(!this.refreshToken)throw Error("Unable to update token, no refresh token available.");e=e||5,this.#a.enable&&await this.#U();let t=!1;if(-1===e?(t=!0,this.#o("[KEYCLOAK] Refreshing token: forced refresh")):(!this.tokenParsed||this.isTokenExpired(e))&&(t=!0,this.#o("[KEYCLOAK] Refreshing token: token expired")),!t)return!1;let{promise:r,resolve:i,reject:o}=Promise.withResolvers();if(this.#e.push({resolve:i,reject:o}),1===this.#e.length){let e=this.endpoints.token(),t=new Date().getTime();try{let r=await f(e,this.refreshToken,this.clientId);this.#o("[KEYCLOAK] Token refreshed"),t=(t+new Date().getTime())/2,this.#C(r.access_token,r.refresh_token,r.id_token,t),this.onAuthRefreshSuccess?.();for(let e=this.#e.pop();null!=e;e=this.#e.pop())e.resolve(!0)}catch(e){this.#n("[KEYCLOAK] Failed to refresh token"),e instanceof b&&400===e.response.status&&this.clearToken(),this.onAuthRefreshError?.();for(let t=this.#e.pop();null!=t;t=this.#e.pop())t.reject(e)}}return await r};clearToken=()=>{this.token&&(this.#C(),this.onAuthLogout?.(),this.loginRequired&&this.login())};#C(e,t,r,i){if(this.tokenTimeoutHandle&&(clearTimeout(this.tokenTimeoutHandle),this.tokenTimeoutHandle=void 0),t?(this.refreshToken=t,this.refreshTokenParsed=c(t)):(delete this.refreshToken,delete this.refreshTokenParsed),r?(this.idToken=r,this.idTokenParsed=c(r)):(delete this.idToken,delete this.idTokenParsed),e){if(this.token=e,this.tokenParsed=c(e),this.sessionId=this.tokenParsed.sid,this.authenticated=!0,this.subject=this.tokenParsed.sub,this.realmAccess=this.tokenParsed.realm_access,this.resourceAccess=this.tokenParsed.resource_access,i&&(this.timeSkew=Math.floor(i/1e3)-this.tokenParsed.iat),null!==this.timeSkew&&(this.#o("[KEYCLOAK] Estimated time difference between browser and server is "+this.timeSkew+" seconds"),this.onTokenExpired)){let e=(this.tokenParsed.exp-new Date().getTime()/1e3+this.timeSkew)*1e3;this.#o("[KEYCLOAK] Token expires in "+Math.round(e/1e3)+" s"),e<=0?this.onTokenExpired():this.tokenTimeoutHandle=window.setTimeout(this.onTokenExpired,e)}}else delete this.token,delete this.tokenParsed,delete this.subject,delete this.realmAccess,delete this.resourceAccess,this.authenticated=!1}#y(){if(void 0!==this.authServerUrl)return`${w(this.authServerUrl)}/realms/${encodeURIComponent(this.realm)}`}#s(e){return t=>{this.enableLogging&&e.call(console,t)}}}function i(){if("undefined"==typeof crypto||void 0===crypto.randomUUID)throw Error("Web Crypto API is not available.");return crypto.randomUUID()}async function o(e,t){if("S256"!==e)throw TypeError(`Invalid value for 'pkceMethod', expected 'S256' but got '${e}'.`);return btoa(String.fromCodePoint(...new Uint8Array(await l(t)))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}let s="kc-callback-";class n{constructor(){globalThis.localStorage.setItem("kc-test","test"),globalThis.localStorage.removeItem("kc-test")}get(e){if(!e)return null;this.#A();let t=s+e,r=globalThis.localStorage.getItem(t);return r?(globalThis.localStorage.removeItem(t),JSON.parse(r)):null}add(e){this.#A();let t=s+e.state,r=JSON.stringify({...e,expires:Date.now()+36e5});try{globalThis.localStorage.setItem(t,r)}catch(e){this.#L(),globalThis.localStorage.setItem(t,r)}}#A(){let e=Date.now();for(let[t,r]of this.#P()){let i=this.#O(r);(null===i||i<e)&&globalThis.localStorage.removeItem(t)}}#L(){for(let[e]of this.#P())globalThis.localStorage.removeItem(e)}#P(){return Object.entries(globalThis.localStorage).filter(([e])=>e.startsWith(s))}#O(e){let t;try{t=JSON.parse(e)}catch(e){return null}return d(t)&&"expires"in t&&"number"==typeof t.expires?t.expires:null}}class a{get(e){if(!e)return null;let t=this.#R(s+e);return(this.#x(s+e,"",this.#M(-100)),t)?JSON.parse(t):null}add(e){this.#x(s+e.state,JSON.stringify(e),this.#M(60))}#R(e){let t=e+"=",r=document.cookie.split(";");for(let e=0;e<r.length;e++){let i=r[e];for(;" "===i.charAt(0);)i=i.substring(1);if(0===i.indexOf(t))return i.substring(t.length,i.length)}return""}#x(e,t,r){let i=e+"="+t+"; expires="+r.toUTCString()+"; ";document.cookie=i}#M(e){let t=new Date;return t.setTime(t.getTime()+6e4*e),t}}async function l(e){let t=new TextEncoder().encode(e);if("undefined"==typeof crypto||void 0===crypto.subtle)throw Error("Web Crypto API is not available.");return await crypto.subtle.digest("SHA-256",t)}function c(e){let t,[,r]=e.split(".");if("string"!=typeof r)throw Error("Unable to decode token, payload not found.");try{t=function(e){let t=e.replaceAll("-","+").replaceAll("_","/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("Input is not of the correct length.")}try{var r;return r=t,decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}catch(e){return atob(t)}}(r)}catch(e){throw Error("Unable to decode token, payload is not a valid Base64URL value.",{cause:e})}try{return JSON.parse(t)}catch(e){throw Error("Unable to decode token, payload is not a valid JSON value.",{cause:e})}}function d(e){return"object"==typeof e&&null!==e}async function h(e){return await g(e)}async function u(e){return await g(e)}async function p(e,t,r,i,o){let s=new URLSearchParams([["code",t],["grant_type","authorization_code"],["client_id",r],["redirect_uri",i]]);return o&&s.append("code_verifier",o),await g(e,{method:"POST",credentials:"include",body:s})}async function f(e,t,r){let i=new URLSearchParams([["grant_type","refresh_token"],["refresh_token",t],["client_id",r]]);return await g(e,{method:"POST",credentials:"include",body:i})}async function g(e,t={}){let r=new Headers(t.headers);r.set("Accept","application/json");let i=await k(e,{...t,headers:r});return await i.json()}async function k(e,t){let r=await fetch(e,t);if(!r.ok)throw new b("Server responded with an invalid status.",{response:r});return r}function m(e){if(!e)throw Error("Unable to build authorization header, token is not set, make sure the user is authenticated.");return["Authorization",`bearer ${e}`]}function w(e){return e.endsWith("/")?e.slice(0,-1):e}class b extends Error{response;constructor(e,t){super(e,t),this.response=t.response}}let y=e=>new Promise(t=>setTimeout(t,e))});
//# sourceMappingURL=keycloak.1ffe3714.js.map
